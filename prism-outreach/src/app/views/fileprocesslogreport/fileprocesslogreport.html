<main id="main" class="main mt-4" style="min-height:550px;">
  <section class="section dashboard">
    <div class="row">
      <div class="col-lg-12">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title text-uppercase">File Process Log Report</h5>
                <form [formGroup]="processLogForm" (ngSubmit)="$event.preventDefault()">
            <div class="row g-2 align-items-center">
              <div class="col-lg-3 text-uppercase">
                <select
                  class="form-control form-select text-uppercase darrow"
                  formControlName="process_type"
                  (change)="onProcessTypeChange()"
                >
                  <option value="">-- SELECT PROCESS TYPE --</option>
                  <option value="Member Process">Member File Process</option>
                  <option value="Risk Gaps Process">Risk Gaps File Process</option>
                  <option value="Quality Gaps Process">Quality Gaps File Process</option>
                </select>
              </div>

              <div class="col-lg-3 text-uppercase">
                <select
                  class="form-control form-select text-uppercase darrow"
                  formControlName="process_list"
                  (change)="onProcessSelect()"
                >
                  <option value="">-- SELECT PROCESS --</option>
                  @for (row of processList; track row.SESSION_ID) {
                    <option [value]="row.SESSION_ID">
                      {{ formatDateTime(row.MIN_LOG_DATE) }}
                    </option>
                  }
                </select>
              </div>

              <div class="col-lg-4"></div>
            </div>
        </form>
          </div>
        </div>
      </div>

      <!-- Table section -->
      <div class="col-lg-3"></div>
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <table class="table table-sm table-striped">
              <thead>
                <tr>
                  <th>Sl No</th>
                  <th>PROCESS MESSAGE</th>
                  <th>COUNT</th>
                  <th>DATE</th>
                </tr>
              </thead>
              <tbody>
                @if (!isLoading && logDetails.length === 0) {
                  <tr>
                    <td colspan="4" class="text-center">No records found</td>
                  </tr>
                }
                @for (log of logDetails; track log.LOG_ID; let i = $index) {
                  <tr>
                    <td>{{ i + 1 }}</td>
                    <td>{{ log.MESSAGE }}</td>
                    <td>{{ log.RECORD_COUNT }}</td>
                    <td>{{ formatDateTime(log.LOG_DATE) }}</td>
                  </tr>
                }
              </tbody>
            </table>

            <!-- Loader -->
            @if (isLoading) {
              <div class="text-center p-3">
                <div class="spinner-border" role="status"></div>
                <div class="small mt-2">Loading...</div>
              </div>
            }
          </div>
        </div>
      </div>
      <div class="col-lg-3"></div>
    </div>
  </section>
</main>
